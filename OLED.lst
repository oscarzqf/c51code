C51 COMPILER V9.01   OLED                                                                  04/21/2021 17:38:50 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE OLED
OBJECT MODULE PLACED IN OLED.obj
COMPILER INVOKED BY: C:\µ¥Æ¬»ú\C51\BIN\C51.EXE OLED_Dino-master\OLED.c BROWSE DEBUG OBJECTEXTEND PRINT(.\OLED.lst) OBJEC
                    -T(OLED.obj)

line level    source

   1          
   2          #include "OLED.h"
*** WARNING C318 IN LINE 5 OF OLED_DINO-MASTER\I2C.H: can't open file 'stc8g.h'
*** ERROR C202 IN LINE 16 OF OLED_DINO-MASTER\I2C.H: 'P3': undefined identifier
*** ERROR C202 IN LINE 17 OF OLED_DINO-MASTER\I2C.H: 'P3': undefined identifier
   3          #include "OLEDFont.h"
   4          
   5          /***OLED12864/0.96'/SSD1306***/
   6          
   7          /**
   8           * @description: 51å»¶æ—¶å‡½æ•° @11.0592MHz
   9           * @param {uint ms æ¯«ç§’} 
  10           * @return: void
  11           */
  12          void Delay_ms(uint ms)
  13          {
  14   1              unsigned char i, j;
  15   1                      while(ms--)
  16   1                      {
  17   2                              _nop_();
  18   2                              _nop_();
  19   2                              _nop_();
  20   2                              i = 11;
  21   2                              j = 190;
  22   2                              do
  23   2                              {
  24   3                                      while (--j);
  25   3                              } while (--i);
  26   2                      }
  27   1      }
  28          
  29          /**
  30           * @function: void OLED_Write_Byte(uchar WCommand,uchar cmdORdata)
  31           * @description: 
  32           * @param {uchar WDataå¾…å†™å…¥çš„å†…å®¹ï¼Œuchar cmdORdataæŒ‡æ˜å†™å…¥æŒ‡ä»¤è¿˜æ˜¯æ•°æ®} 
  33           * @return: void
  34           */
  35          void OLED_Write_Byte(uchar WData, uchar cmdORdata)
  36          {
  37   1          I2C_Start();
  38   1          I2C_Write_Byte(OLED_Addr + 0); //å†™å…¥å™¨ä»¶åœ°å€(bit0=1è¯»ï¼Œbit0=0å†™)
  39   1          I2C_Wait_Ack();
  40   1          I2C_Write_Byte(cmdORdata); //æŒ‡æ˜å†™å…¥æŒ‡ä»¤è¿˜æ˜¯æ•°æ®
  41   1          I2C_Wait_Ack();
  42   1          I2C_Write_Byte(WData); //å†™å…¥æ•°æ®å†…å®¹
  43   1          I2C_Wait_Ack();
  44   1          I2C_Stop();
  45   1      }
  46          
  47          /**
  48           * @function: void OLED_Fill(uchar Fill_Data)
  49           * @description: å…¨å±æ˜¾ç¤ºç›¸åŒæ•°æ®(ä¸»è¦ç”¨å»æ¸…å±)
  50           * @param {uchar Fill_Dataå¾…å…¨å±å†™å…¥çš„æ•°æ®} 
  51           * @return: void
C51 COMPILER V9.01   OLED                                                                  04/21/2021 17:38:50 PAGE 2   

  52           */
  53          void OLED_Fill(uchar Fill_Data)
  54          {
  55   1          uchar i, j;
  56   1          for (i = 0; i < 8; i++) //8é¡µï¼Œå…±éœ€è¦å¾ªç¯æ˜¾ç¤º8æ¬¡
  57   1          {
  58   2              OLED_Write_Byte(0xb0 + i, isCmd); //é¡µåœ°å€0~7
  59   2              OLED_Write_Byte(0x10, isCmd);     //è®¾ç½®é«˜ä½åˆ—åœ°å€
  60   2              OLED_Write_Byte(0x00, isCmd);     //è®¾ç½®ä½ä½åˆ—åœ°å€
  61   2              for (j = 0; j < OLED_Width; j++)  //æ¯é¡µæœ‰128åˆ—éœ€è¦æ˜¾ç¤º
  62   2                  OLED_Write_Byte(Fill_Data, isData);
  63   2          }
  64   1      }
  65          
  66          
  67          /**
  68           * @function: void OLED_Set_Pos(uchar x,uchar y)
  69           * @description: è®¾ç½®èµ·å§‹æ˜¾ç¤ºä½ç½®
  70           * @param {uchar xèµ·å§‹æ˜¾ç¤ºåˆ—0~127ã€uchar yèµ·å§‹æ˜¾ç¤ºé¡µ0~7} 
  71           * @return: void
  72           */
  73          void OLED_Set_Pos(uchar x, uchar y)
  74          {
  75   1          OLED_Write_Byte(0xb0 + y, isCmd);               //èµ·å§‹æ˜¾ç¤ºçš„é¡µ
  76   1          OLED_Write_Byte((x & 0xf0) >> 4 | 0x10, isCmd); //è®¾ç½®é«˜ä½åˆ—åœ°å€
  77   1          OLED_Write_Byte(x & 0x0f, isCmd);               //è®¾ç½®ä½ä½åˆ—åœ°å€
  78   1      }
  79          
  80          /**
  81           * @function: void OLED_Init()
  82           * @description: OLEDåˆå§‹åŒ–å‡½æ•°
  83           * @param {void} 
  84           * @return: void
  85           */
  86          void OLED_Init()
  87          {
  88   1          Delay_ms(200);
  89   1          OLED_Write_Byte(0xae, isCmd); //å…³é—­æ˜¾ç¤ºå™¨ display off
  90   1          OLED_Write_Byte(0x00, isCmd); //è®¾ç½®ä½ä½åˆ—åœ°å€ set low column address
  91   1          OLED_Write_Byte(0x10, isCmd); //è®¾ç½®é«˜ä½åˆ—åœ°å€ set high column address
  92   1          OLED_Write_Byte(0x40, isCmd); //è®¾ç½®èµ·å§‹è¡Œåœ°å€ set start line address
  93   1          OLED_Write_Byte(0xb0, isCmd); //è®¾ç½®é¡µåœ°å€ set page address
  94   1          OLED_Write_Byte(0x81, isCmd); //è®¾ç½®å¯¹æ¯”åº¦
  95   1          OLED_Write_Byte(0xff, isCmd); //å¯¹æ¯”åº¦,æ•°å€¼è¶Šå¤§å¯¹æ¯”åº¦è¶Šé«˜
  96   1          OLED_Write_Byte(0xa1, isCmd); //è®¾ç½®æ®µé‡æ–°æ˜ å°„ ä¸å·¦å³ç¿»è½¬set segment remap
  97   1          OLED_Write_Byte(0xa6, isCmd); //è®¾ç½®æ­£å¸¸/åå‘ normal / reverse
  98   1          OLED_Write_Byte(0xa8, isCmd); //è®¾ç½®å¤šè·¯å¤ç”¨æ¯”(1-64) set multiplex ratio(1 to 64)
  99   1          OLED_Write_Byte(0x3f, isCmd); //è®¾å®šå€¼1/32  1/32 duty
 100   1          OLED_Write_Byte(0xc8, isCmd); //æ‰«ææ–¹å‘ ä¸ä¸Šä¸‹ç¿»è½¬Com scan direction
 101   1      
 102   1          OLED_Write_Byte(0xd3, isCmd); //è®¾ç½®æ˜¾ç¤ºåç§» set display offset
 103   1          OLED_Write_Byte(0x00, isCmd); //
 104   1      
 105   1          OLED_Write_Byte(0xd5, isCmd); //è®¾ç½®oscåˆ†åŒº set osc division
 106   1          OLED_Write_Byte(0x80, isCmd); //
 107   1      
 108   1          OLED_Write_Byte(0xd8, isCmd); //å…³é—­åŒºåŸŸé¢œè‰²æ¨¡å¼ set area color mode off
 109   1          OLED_Write_Byte(0x05, isCmd); //
 110   1      
 111   1          OLED_Write_Byte(0xd9, isCmd); //è®¾ç½®é¢„å……ç”µæœŸ Set Pre-Charge Period
 112   1          OLED_Write_Byte(0xf1, isCmd); //
 113   1      
C51 COMPILER V9.01   OLED                                                                  04/21/2021 17:38:50 PAGE 3   

 114   1          OLED_Write_Byte(0xda, isCmd); //è®¾ç½®comå¼•è„šé…ç½® set com pin configuartion
 115   1          OLED_Write_Byte(0x12, isCmd); //
 116   1      
 117   1          OLED_Write_Byte(0xdb, isCmd); //è®¾ç½®vcomh set Vcomh
 118   1          OLED_Write_Byte(0x30, isCmd); //
 119   1      
 120   1          OLED_Write_Byte(0x8d, isCmd); //è®¾ç½®ç”µæºæ³µå¯ç”¨ set charge pump enable
 121   1          OLED_Write_Byte(0x14, isCmd); //
 122   1      
 123   1          OLED_Write_Byte(0xa4, isCmd); //è®¾ç½®å…¨å±€æ˜¾ç¤ºå¼€å¯ï¼›bit0ï¼Œ1å¼€å¯ï¼Œ0å…³é—­(ç™½å±/é»‘å±)
 124   1          OLED_Write_Byte(0xa6, isCmd); //è®¾ç½®æ˜¾ç¤ºæ–¹å¼ï¼Œbit0ï¼Œ1åç›¸æ˜¾ç¤ºï¼Œ0æ­£å¸¸æ˜¾ç¤º
 125   1      
 126   1          OLED_Write_Byte(0xaf, isCmd); //æ‰“å¼€oledé¢æ¿ turn on oled panel
 127   1      
 128   1          OLED_Fill(0x00); //æ¸…å±
 129   1      }
 130          
 131          /**
 132           * @function: void OLED_DisplayChar(uchar x, uchar y, uchar DisplayChar, uchar TextSize)
 133           * @description: åœ¨OLED12864ç‰¹å®šä½ç½®æ˜¾ç¤ºä¸€ä¸ªå­—ç¬¦
 134           * @param {uchar xåˆ—, uchar yè¡Œ, uchar DisplayCharæ˜¾ç¤ºçš„å­—ç¬¦, uchar TextSizeå­—ä½“å¤§å°} 
 135           * @return: void
 136           */
 137          void OLED_DisplayChar(uchar x, uchar y, uchar DisplayChar)
 138          {
 139   1          uchar c = 0, i;
 140   1          c = DisplayChar - 32; //ç­‰åŒäºå‡å»ä¸ªç©ºæ ¼c = DisplayChar - ' '; å¾—åˆ°æ˜¾ç¤ºå­—ç¬¦åœ¨åº“ä¸­çš„å
             -ç§»åœ°å€
 141   1                      OLED_Set_Pos(x, y); //å¼€å§‹æ˜¾ç¤ºä½ç½®
 142   1                      for (i = 0; i < 6; i++)
 143   1                                      OLED_Write_Byte(F6X8[c][i], isData); //æ˜¾ç¤ºä¸€ä¸ª6X8å­—ç¬¦
 144   1      }
 145          
 146          /**
 147           * @function: void OLED_DisplayStr(uchar x, uchar y, uchar *DisplayStr, uchar TextSize)
 148           * @description: åœ¨OLED12864ç‰¹å®šä½ç½®æ˜¾ç¤ºå­—ç¬¦ä¸²
 149           * @param {uchar xåˆ—, uchar yè¡Œ, uchar *DisplayStrå¾…æ˜¾ç¤ºçš„å­—ç¬¦ä¸², uchar TextSizeå­—ä½“å¤§å°} 
 150           * @return: void
 151           */
 152          void OLED_DisplayStr(uchar x, uchar y, uchar *DisplayStr) //(uchar *DisplayStr)æ”¹æˆ(uchar DisplayStr[])ä
             -¹Ÿå¯
 153          {
 154   1          uchar j = 0;
 155   1          while (DisplayStr[j] != '\0') //åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ˜¾ç¤ºå®Œæˆ
 156   1          {
 157   2              OLED_DisplayChar(x, y, DisplayStr[j]);
 158   2              x += 6;
 159   2      
 160   2              if (x > 122) //TextSize6x8å¦‚æœä¸€è¡Œä¸å¤Ÿæ˜¾ç¤ºäº†ï¼Œä»ä¸‹ä¸€è¡Œç»§ç»­æ˜¾ç¤º
 161   2              {
 162   3                  x = 0;
 163   3                  y++;
 164   3              }
 165   2              j++;
 166   2          }
 167   1      }
 168          
 169          /**
 170           * @function: void OLED_DisplayBMP(uchar x0, uchar y0, uchar x1, uchar y1, uchar *BMP)
 171           * @description: åœ¨OLED12864ç‰¹å®šä½ç½®æ˜¾ç¤ºBMPå›¾ç‰‡
 172           * @param {uchar x0,uchar y0(x0,y0æ˜¾ç¤ºèµ·ç‚¹åæ ‡x:0~127,y0:0~7)ã€uchar x1,uchar y1(x1,y1æ˜¾ç¤ºç»“æŸå
             -æ ‡x0:0~127,y0:0~7)ã€uchar *BMPå¾…æ˜¾ç¤ºçš„å›¾ç‰‡æ•°æ®} 
C51 COMPILER V9.01   OLED                                                                  04/21/2021 17:38:50 PAGE 4   

 173           * @return: void
 174           */
 175          #if 0
              void OLED_DisplayBMP(uchar x0, uchar y0, uchar x1, uchar y1, uchar *BMP)
              {
                  uint j = 0;
                  uchar x, y;
                  if (y1 % 8 == 0) //ç”¨äºç¡®å®šæ˜¾ç¤ºå‡ é¡µ
                      y = y1 / 8;
                  else
                      y = y1 / 8 + 1;
                  for (y = y0; y < y1; y++) //ä»è®¾ç½®çš„èµ·å§‹é¡µå¼€å§‹æ˜¾ç¤ºåˆ°ç»“æŸé¡µ
                  {
                      OLED_Set_Pos(x0, y);                   //è¿›å…¥ä¸‹ä¸€é¡µæ˜¾ç¤ºèµ·å§‹ä½ç½®
                      for (x = x0; x < x1; x++)              //ä»è®¾ç½®å¼€å§‹åˆ—æ˜¾ç¤ºåˆ°ç»“æŸåˆ—
                          OLED_Write_Byte(BMP[j++], isData); //é€ä¸ªä¼ å…¥æ˜¾ç¤ºæ•°æ®
                  }
              }
              #endif

C51 COMPILATION COMPLETE.  1 WARNING(S),  2 ERROR(S)
